<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/5cd1e1d933.js"></script>
    <link href="//cdn.quilljs.com/1.0.0/quill.snow.css" rel="stylesheet">
    <link href="//cdn.quilljs.com/1.0.0/quill.bubble.css" rel="stylesheet"> 
    <link rel="stylesheet" href="./style.css">
    <title>GO-WEB</title>
</head>
<body>
    <div id="app">
        <!-- Landing Page -->
        <header v-show="isHeader">
            <h1>welcome in Hackticle</h1>
            <p>the first  Official Website to provide information about hacking in the world</p>
            <button @click="getDashboard" type="button" class="btn btn-outline-secondary get-started">GET STARTED</button>
        </header>
        <!-- Akhir landing Page -->
    
        <!-- Navbar -->
        <nav v-show="isNav" class="navbar navbar-expand-lg navbar-light bg-light">
            <a @click="showMenu" href="#"class="navbar-logo"><img src="http://www.pngall.com/wp-content/uploads/2/Rocket-PNG-High-Quality-Image.png" alt="Logo"></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item dropdown">
                        <a class="nav-link" href="#" @click="getDashboard">Hackticle</a>
                    </li>
                </ul>
                <button class="btn btn-outline-secondary" @click="getPage3">Write</button>
                <form class="form-inline my-2 my-lg-0">
                    <input class="form-control type-search" type="search" placeholder="Search" aria-label="Search">
                    <button class="btn btn-outline-secondary" id="btn-search">Search</button>
                </form>
            </div>
        </nav>
        <!-- Akhir Navbar -->
    
        <!-- Menu -->
        <div v-bind:class="{'menu-show': isMenu, menu : true}" >
            <ul>
                <li><a href="#"><i class="fas fa-desktop"></i> View Site</a></li>
                <li><a href="#"><i class="fas fa-chart-bar"></i> Stats</a></li>
                <li><a href="#"><i class="fas fa-history"></i> Activity</a></li>
                <li><a href="#">Plan</a></li>
                <li>Manage</li>
                <li><a href="#"><i class="far fa-file"></i> Site Pages</a> <button>Add</button></li>
                <li><a href="#">Blog Posts</a> <button>Add</button></li>
                <li><a href="#">Media</a> <button>Add</button></li>
                <li><a href="#">Comments</a></li>
                <li><a href="#">Feedback</a> <button>Add</button></li>
                <li><a href="#">Plugins</a> <button>Manage</button></li>
                <li><a href="#">Import</a></li>
                <li>Personalize</li>
                <li><a href="#">Customize</a> <button>Themes</button></li>
            </ul>
        </div>
        <!-- Akhir Menu -->
    
        <!-- create Article -->
        <div v-show="isCreateArticle" class="create-article">
            <form>
                <input type="text" placeholder="Title" class="form-control" v-model="title">
            </form>
            <div id="content">
    
            </div>
            <button class="btn btn-outline-secondary" @click="createArticle">Publish</button>
        </div>
        <!-- Akhhir Create Article -->
    
        <!-- Article -->
        <article v-show="isArticle">
            <div class="col-headline">
                <div class="title">
                    <h1>{{ titleHead }}</h1>
                </div>
    
                <div class="author" style="font-size: 10px ">
                    <p>Author  : {{ authorHead }}</p>
                    <p>Publish : {{ createdAthead }}</p>
                </div>
    
                <div class="article" style="margin-top: 20px">
                    <p v-html="contentHead"></p>
                </div>
    
            </div>
    
            <div class="col-article">
                <h3>List Article</h3>
                <div class="article-list">
                    <ul>
                        <li v-for="article in articles">
                            <a @click="updateHeadline(article.title, article.author, article.created_at, article.content)" href="#">{{ article.title }}</a>
                        </li>
                    </ul>
                </div>
            </div>
        </article>
        <!-- Akhir Article -->
    </div>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="//cdn.quilljs.com/1.0.0/quill.js"></script>
    <script src="//cdn.quilljs.com/1.0.0/quill.min.js"></script>
    <script src="./script/index.js"></script>
    <script src="./script/article.js"></script>
    <script>
        let quill = null
        let vm = new Vue({
            el: '#app',
            data : {
                articles : "",
                isHeader : true,
                isArticle : false,
                isNav : false,
                isCreateArticle : false,
                isMenu : false,
                title : "",
                titleHead : null,
                authorHead : null,
                createdAthead : null,
                contentHead : null 
            },
            methods : {
                findAll : function(){
                    axios({
                        method : 'get',
                        url : 'http://localhost:3000/articles'
                    })
                    .then(response => {
                        this.articles = response.data
                        this.titleHead = this.articles[0].title
                        this.authorHead = this.articles[0].author
                        this.createdAthead = this.articles[0].created_at
                        this.contentHead = this.articles[0].content
                        // console.log(this.articles)
                    })
                    .catch(err => {
                        console.log(err)
                    })
                },
                getDashboard : function(){
                    
                    this.isNav = true
                    this.isArticle = true
                    this.isHeader = false
                    this.isCreateArticle = false
                },
                createArticle : function(){
                    let date = new Date()
                    let getYear = date.getFullYear()
                    let getMonth = date.getMonth()
                    let getDate = date.getDate()
                    console.log(quill.root.innerHTML)
                    let title = this.title
                    let content = quill.root.innerHTML
                    let author = 'Ghozi'
                    let created_at = `${getYear}-${getMonth}-${getDate}`

                    axios({
                        method : 'post',
                        url : 'http://localhost:3000/articles',
                        data : {
                            title, content, author, created_at
                        }
                    })
                    .then(response => {
                        this.getDashboard()
                    })
                    .catch(err => {
                        console.log(err)
                    }) 
                },
                getPage3 : function(){
                    if(!quill){
                        quill = new Quill('#content', {theme : 'snow', placeholder : 'Content'});
                    }
                    this.isCreateArticle = true
                    this.isMenu = false
                    this.isArticle = false
                },
                updateHeadline : function(title, author, created_at, content){
                    this.titleHead = title
                    this.authorHead = author
                    this.createdAthead = created_at
                    this.contentHead = content
                },
                showMenu : function(){
                    console.log(`<<<<<<<<<<<<<<<,,,,,mausk`)
                    if(this.isMenu) this.isMenu = false
                    else this.isMenu = true
                }
            },
            created: function(){
                this.findAll()
            }
        })
    </script>
</body>
</html>